# Детектор коротких заставок в сериалах

Этот проект представляет собой решение задачи автоматического поиска коротких заставок в сериалах. Заставка сериала - повторяющийся от серии к серии фрагмент, связанный с представлением данного сериала. Цель проекта - определить время начала и конца короткой заставки, где обычно показывают только название сериала.

## Описание подхода

Подход к решению задачи основан на поиске повторяющихся фрагментов видео с использованием "отпечатков" (fingerprints) визуальных и аудио-компонентов:

1. **Извлечение визуальных признаков**:
   - Перцептивные хеши кадров (pHash)
   - Цветовые гистограммы
   - Детекция переходов между сценами

2. **Извлечение аудио-признаков**:
   - MFCC (Mel-frequency cepstral coefficients)
   - Спектральный контраст
   - Огибающая громкости

3. **Поиск заставок**:
   - Построение матрицы сходства между отпечатками
   - Поиск диагональных паттернов высокой схожести в матрице
   - Фильтрация кандидатов на заставки по длительности и степени сходства

## Структура проекта

```
tv_intro_detector/
├── configs/            # Конфигурационные файлы
├── data/               # Данные для обработки
│   ├── raw/            # Исходные видеофайлы
│   └── processed/      # Обработанные данные
├── notebooks/          # Jupyter ноутбуки для экспериментов
├── scripts/            # Скрипты для запуска
└── src/                # Исходный код
    ├── features/       # Извлечение признаков
    ├── models/         # Модели для детекции заставок
    └── utils/          # Вспомогательные модули
```

## Требования

Для работы с проектом необходимы следующие библиотеки:

- Python 3.7+
- OpenCV (cv2)
- NumPy
- librosa
- scikit-learn (опционально)

Установка зависимостей:
```
pip install numpy opencv-python librosa scikit-learn
```

## Использование

### Обнаружение заставок в видео

```bash
python scripts/run_detector.py --data_dir /путь/к/директории/с/видео --output результаты.json
```

### Оценка результатов (если есть аннотации)

```bash
python scripts/run_detector.py --data_dir /путь/к/директории/с/видео --annotations /путь/к/аннотациям.json --evaluate
```

## Параметры

Основные параметры детектора настраиваются в файле `configs/default_config.json`:

- `min_intro_length`: Минимальная длительность заставки (сек)
- `max_intro_length`: Максимальная длительность заставки (сек)
- `similarity_threshold`: Порог сходства для определения заставок

## Данные

Для работы с проектом необходимы видеофайлы сериалов. Примеры сериалов с временами заставок можно скачать по следующим ссылкам:

- [Набор данных 1](https://disk.yandex.ru/d/1sqxBbA1hRumDQ)
- [Набор данных 2](https://disk.yandex.ru/d/Be8jLxVcQZ70IQ)
- [JSON с временами заставок](https://disk.yandex.ru/d/PEOGKbj5qJmGlQ) 